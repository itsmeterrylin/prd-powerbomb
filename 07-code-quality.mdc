---
globs: *.swift,*.py,*.json,*.html,*.js,*.css,*.ts
alwaysApply: false
---

âœ… Universal Code Quality Rules (Swift & Python)
	â€¢	Max 2 levels of nesting (if / else / loop)
	â€¢	Functions should be small & single-purpose (<30 lines)
	â€¢	No magic values â†’ use let/const or named constants
	â€¢	Use intention-revealing names for vars, funcs, classes
	â€¢	Avoid silent catch blocks â€” log or explicitly handle
	â€¢	Avoid duplicating state across local/props/context
	â€¢	Add // TODO(name, date) or # TODO(name, date) for hacks
	â€¢	No unnecessary fallbacks â€” document if needed
	â€¢	Expensive loops or filters must be memoized or paginated

â¸»

ðŸ Python-Specific
	â€¢	Explicit is better than implicit. Donâ€™t hide behavior in dunder methods or decorators unless standard.
	â€¢	Use typing for all public functions/classes. Especially return values.
	â€¢	Donâ€™t mutate arguments in-place. Always return new values unless explicitly designed to do so.
	â€¢	Use dataclasses or Pydantic for structured data, not loose dicts.
	â€¢	Group related functions into modules, not long files.
	â€¢	Use __all__ or single-point exports. Avoid accidental public exposure.
	â€¢	Donâ€™t catch Exception broadly. Use specific error types.
	â€¢	Use pathlib and logging instead of os.path and print.
	â€¢	Stick to black and ruff/flake8 for style and linting.

â¸»

ðŸŽ Swift-Specific
	â€¢	Avoid force unwrapping (!) â€” always use guard let, if let, or default values
	â€¢	Use struct by default, only use class if you need reference semantics
	â€¢	Functions should return immutable values unless youâ€™re explicitly mutating state
	â€¢	Favor value types (struct/enums) + protocol conformance
	â€¢	Avoid deep optional chaining â€” prefer early returns with guard
	â€¢	Use private(set) or internal access control to encapsulate state
	â€¢	Group related code using extensions â€” keeps logic modular and discoverable
	â€¢	Use @MainActor or concurrency annotations clearly
	â€¢	Use SwiftLint for consistent style, and mark temporary disables with // swiftlint:disable [rule] // TODO(name, date)

    Use curl to test backend changes, JWT is included in /Users/terrylin/WorkoutVoice/backend/.env under JWT_TEST
    Use test audio files in this folder to test transcription/tagging endpoints: /Users/terrylin/WorkoutVoice/backend/tests/audio-files